<template>
  <div class="login">
    <div class="left-content">
      <div class="left-container">
        <div class="d-flex column gap12">
          <svg xmlns="http://www.w3.org/2000/svg" width="156" height="126" viewBox="0 0 156 126" fill="none">
            <g clip-path="url(#clip0_202_1397)">
            <rect width="156" height="126" rx="20" fill="#5565FF"/>
            <path d="M73.5557 60.0596C73.1924 59.7842 73.1045 59.5059 73.292 59.2246L73.9688 58.2051C74.1914 57.8711 74.5166 57.8535 74.9443 58.1523C75.2725 58.3809 75.7002 58.6182 76.2275 58.8643C76.7607 59.1045 77.3203 59.2246 77.9062 59.2246C78.3164 59.2246 78.7119 59.1777 79.0928 59.084C79.4736 58.9902 79.7637 58.8086 79.9629 58.5391C80.1621 58.2695 80.2617 57.9502 80.2617 57.5811C80.2617 57.3174 80.2178 57.0859 80.1299 56.8867C80.042 56.6875 79.8984 56.5234 79.6992 56.3945C79.5 56.2656 79.2949 56.1572 79.084 56.0693C78.7148 55.917 78.249 55.7676 77.6865 55.6211C77.1299 55.4688 76.5791 55.2871 76.0342 55.0762C75.5479 54.8887 75.1025 54.6309 74.6982 54.3027C74.2939 53.9746 73.9805 53.6055 73.7578 53.1953C73.5352 52.7852 73.4238 52.2373 73.4238 51.5518C73.4238 50.7373 73.6875 50.04 74.2148 49.46C74.7422 48.8799 75.3486 48.5078 76.0342 48.3438C76.7197 48.1797 77.4111 48.0977 78.1084 48.0977C78.7998 48.0977 79.5117 48.2031 80.2441 48.4141C80.9824 48.625 81.5391 48.8887 81.9141 49.2051C82.2832 49.5156 82.374 49.7969 82.1865 50.0488L81.4746 51.0068C81.2344 51.335 80.9121 51.3613 80.5078 51.0859C80.25 50.9102 79.8955 50.7139 79.4443 50.4971C78.999 50.2803 78.5332 50.1719 78.0469 50.1719C77.7012 50.1719 77.3818 50.2012 77.0889 50.2598C76.8018 50.3184 76.5469 50.459 76.3242 50.6816C76.1016 50.9043 75.9902 51.1797 75.9902 51.5078C75.9902 51.8242 76.0723 52.082 76.2363 52.2812C76.4004 52.4746 76.582 52.6211 76.7812 52.7207C76.9805 52.8145 77.1826 52.8936 77.3877 52.958C78.0205 53.1631 78.5859 53.3447 79.084 53.5029C79.582 53.6553 80.042 53.8252 80.4639 54.0127C81.0498 54.2764 81.498 54.54 81.8086 54.8037C82.1191 55.0674 82.374 55.4277 82.5732 55.8848C82.7783 56.3418 82.8809 56.8867 82.8809 57.5195C82.8809 58.457 82.582 59.2334 81.9844 59.8486C81.3867 60.458 80.7217 60.8506 79.9893 61.0264C79.2627 61.208 78.5537 61.2988 77.8623 61.2988C76.8428 61.2988 76.0137 61.1992 75.375 61C74.7363 60.8066 74.1299 60.4932 73.5557 60.0596ZM84.5068 61C84.085 61 83.9473 60.8066 84.0938 60.4199L88.4004 49.1084C88.582 48.6338 88.8574 48.3965 89.2266 48.3965H90.457C90.8262 48.3965 91.1016 48.6338 91.2832 49.1084L95.5898 60.4199C95.7363 60.8066 95.5986 61 95.1768 61H93.7793C93.3926 61 93.123 60.7979 92.9707 60.3936L92.0742 58.0293H87.6094L86.7129 60.3936C86.5605 60.7979 86.291 61 85.9043 61H84.5068ZM88.4268 55.8496H91.2568L90.1758 53.0547C90.0469 52.7266 89.9678 52.4893 89.9385 52.3428C89.915 52.1904 89.8887 51.9678 89.8594 51.6748H89.8242C89.7949 51.9678 89.7656 52.1904 89.7363 52.3428C89.7129 52.4893 89.6367 52.7266 89.5078 53.0547L88.4268 55.8496ZM97.7695 61C97.3594 61 97.1543 60.7803 97.1543 60.3408V49.0557C97.1543 48.6162 97.3594 48.3965 97.7695 48.3965H104.722C105.161 48.3965 105.381 48.5869 105.381 48.9678V50.0049C105.381 50.3857 105.161 50.5762 104.722 50.5762H99.7207V53.6348H104.001C104.44 53.6348 104.66 53.8252 104.66 54.2061V55.2432C104.66 55.624 104.44 55.8145 104.001 55.8145H99.7207V60.3408C99.7207 60.7803 99.5156 61 99.1055 61H97.7695ZM106.444 61C106.022 61 105.885 60.8066 106.031 60.4199L110.338 49.1084C110.52 48.6338 110.795 48.3965 111.164 48.3965H112.395C112.764 48.3965 113.039 48.6338 113.221 49.1084L117.527 60.4199C117.674 60.8066 117.536 61 117.114 61H115.717C115.33 61 115.061 60.7979 114.908 60.3936L114.012 58.0293H109.547L108.65 60.3936C108.498 60.7979 108.229 61 107.842 61H106.444ZM110.364 55.8496H113.194L112.113 53.0547C111.984 52.7266 111.905 52.4893 111.876 52.3428C111.853 52.1904 111.826 51.9678 111.797 51.6748H111.762C111.732 51.9678 111.703 52.1904 111.674 52.3428C111.65 52.4893 111.574 52.7266 111.445 53.0547L110.364 55.8496ZM74.0215 79C73.6113 79 73.4062 78.7803 73.4062 78.3408V67.0557C73.4062 66.6162 73.6113 66.3965 74.0215 66.3965H76.5703C76.9102 66.3965 77.1533 66.6309 77.2998 67.0996L79.6816 74.8076C79.7871 75.1416 79.8604 75.417 79.9014 75.6338C79.9424 75.8447 79.9775 76.0967 80.0068 76.3896H80.0596C80.0889 76.0967 80.124 75.8447 80.165 75.6338C80.2061 75.417 80.2793 75.1416 80.3848 74.8076L82.7666 67.0996C82.9131 66.6309 83.1562 66.3965 83.4961 66.3965H86.0449C86.4551 66.3965 86.6602 66.6162 86.6602 67.0557V78.3408C86.6602 78.7803 86.4551 79 86.0449 79H84.709C84.2988 79 84.0938 78.7803 84.0938 78.3408V71.0811C84.0938 70.7295 84.1084 70.3779 84.1377 70.0264H84.0762L81.5361 78.2881C81.3896 78.7627 81.1377 79 80.7803 79H79.2861C78.9287 79 78.6768 78.7627 78.5303 78.2881L75.9902 70.0264H75.9287C75.958 70.3779 75.9727 70.7295 75.9727 71.0811V78.3408C75.9727 78.7803 75.7676 79 75.3574 79H74.0215ZM89.0771 79C88.6553 79 88.5176 78.8066 88.6641 78.4199L92.9707 67.1084C93.1523 66.6338 93.4277 66.3965 93.7969 66.3965H95.0273C95.3965 66.3965 95.6719 66.6338 95.8535 67.1084L100.16 78.4199C100.307 78.8066 100.169 79 99.7471 79H98.3496C97.9629 79 97.6934 78.7979 97.541 78.3936L96.6445 76.0293H92.1797L91.2832 78.3936C91.1309 78.7979 90.8613 79 90.4746 79H89.0771ZM92.9971 73.8496H95.8271L94.7461 71.0547C94.6172 70.7266 94.5381 70.4893 94.5088 70.3428C94.4854 70.1904 94.459 69.9678 94.4297 69.6748H94.3945C94.3652 69.9678 94.3359 70.1904 94.3066 70.3428C94.2832 70.4893 94.207 70.7266 94.0781 71.0547L92.9971 73.8496ZM102.34 79C101.93 79 101.725 78.7803 101.725 78.3408V67.0557C101.725 66.6162 101.93 66.3965 102.34 66.3965H106.409C108.22 66.3965 109.541 66.6777 110.373 67.2402C111.205 67.7969 111.621 68.7051 111.621 69.9648C111.621 70.9023 111.284 71.6494 110.61 72.2061C109.937 72.7627 109.081 73.1318 108.044 73.3135V73.3311C108.606 73.542 109.031 73.835 109.318 74.21C109.605 74.585 109.84 74.9131 110.021 75.1943L111.955 78.2441C112.277 78.748 112.166 79 111.621 79H110.092C109.77 79 109.506 78.8271 109.301 78.4814L107.525 75.5195C107.332 75.2031 106.978 74.8574 106.462 74.4824C105.952 74.1016 105.445 73.9111 104.941 73.9111H104.291V78.3408C104.291 78.7803 104.086 79 103.676 79H102.34ZM104.291 71.7314H105.864C107.036 71.7314 107.868 71.5996 108.36 71.3359C108.858 71.0664 109.107 70.6416 109.107 70.0615C109.107 69.4287 108.867 69.0186 108.387 68.8311C107.912 68.6377 107.212 68.541 106.286 68.541H104.291V71.7314ZM114.891 79C114.48 79 114.275 78.7803 114.275 78.3408V67.0557C114.275 66.6162 114.48 66.3965 114.891 66.3965H116.227C116.637 66.3965 116.842 66.6162 116.842 67.0557V70.5537C116.842 70.9053 116.827 71.2568 116.798 71.6084H116.859L121.131 66.915C121.447 66.5693 121.717 66.3965 121.939 66.3965H123.706C124.392 66.3965 124.503 66.6484 124.04 67.1523L120.041 71.5293L124.321 78.2441C124.644 78.748 124.532 79 123.987 79H122.344C122.039 79 121.775 78.8271 121.553 78.4814L118.318 73.4102L116.842 75.0713V78.3408C116.842 78.7803 116.637 79 116.227 79H114.891ZM126.861 79C126.451 79 126.246 78.7803 126.246 78.3408V67.0557C126.246 66.6162 126.451 66.3965 126.861 66.3965H134.402C134.842 66.3965 135.062 66.5869 135.062 66.9678V68.0049C135.062 68.3857 134.842 68.5762 134.402 68.5762H128.812V71.3711H133.937C134.376 71.3711 134.596 71.5615 134.596 71.9424V72.9795C134.596 73.3604 134.376 73.5508 133.937 73.5508H128.812V76.8203H134.684C135.123 76.8203 135.343 77.0107 135.343 77.3916V78.4287C135.343 78.8096 135.123 79 134.684 79H126.861ZM137.048 68.6465C136.608 68.6465 136.389 68.4561 136.389 68.0752V66.9678C136.389 66.5869 136.608 66.3965 137.048 66.3965H146.083C146.522 66.3965 146.742 66.5869 146.742 66.9678V68.0752C146.742 68.4561 146.522 68.6465 146.083 68.6465H142.849V78.5166C142.849 78.8389 142.702 79 142.409 79H140.722C140.429 79 140.282 78.8389 140.282 78.5166V68.6465H137.048Z" fill="white"/>
            </g>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M9.5 51H8.5V45H9.5H16H18.1115L18.824 46.9876L27.6115 71.5H50.6671L33.5591 62.1313L33.5352 62.1182L33.5116 62.1047L30.0116 60.1047L29.0164 59.5361L28.6539 58.4487L28.1539 56.9487L26.8588 53.0634L30.9539 53.0004L63.4538 52.5004L63.9643 52.4925L64.4487 52.654L65.9487 53.154L64.0513 58.8461L63.0357 58.5075L40.0785 58.8607L57.4409 68.3687L59.543 69.5198L58.8846 71.8242L57.8846 75.3242L57.2629 77.5H55H25.5H23.3885L22.676 75.5124L13.8885 51H9.5Z" fill="white"/>
            <rect x="63" y="58.515" width="2" height="0.5" fill="#5565FF"/>
            <defs>
            <clipPath id="clip0_202_1397">
            <rect width="156" height="126" rx="20" fill="white"/>
            </clipPath>
            </defs>
            </svg>
          <h3 class="login-title">Xush kelibsiz</h3>
          <p>Iltimos login va parolingizni kiriting</p>
        </div>
        <div class="login-container-form">
          <div class="form-item d-flex radius1 border1">
            <input type="text" :value="login" @input="login = $event.target.value.trim()" placeholder="Ismingizni kiriting">
            <Icons name="user" />
          </div>
          <div class="form-item d-flex radius1 border1">
            <input :type="!type ? 'password' : 'text'" :value="password" @input="password = $event.target.value.trim()" placeholder="Parolingizni kiriting">
            <Icons name="password" @click="type = !type" />
          </div>
          <button type="button" @click="handleLogin" class="login-create">Sahifaga kirish</button>
        </div>
      </div>
    </div>
    <div class="right-content">
      <svg xmlns="http://www.w3.org/2000/svg" width="407" height="39" viewBox="0 0 407 39" fill="none">
        <path d="M35.08 32.536C37.9387 32.536 39.368 30.9147 39.368 27.672C39.368 24.4293 37.9387 22.808 35.08 22.808H34.504V16.408C38.2587 16.408 41.096 17.1547 43.016 18.648C44.936 20.1413 45.896 22.488 45.896 25.688V29.464C45.896 32.664 45 35.0533 43.208 36.632C41.416 38.2107 38.5787 39 34.696 39H0.648V32.536H35.08ZM11.464 6.68C8.60533 6.68 7.176 8.30133 7.176 11.544C7.176 14.7867 8.60533 16.408 11.464 16.408H12.04V22.808C4.44533 22.808 0.648 19.7147 0.648 13.528V9.752C0.648 3.39467 4.40267 0.216 11.912 0.216H45.896V6.68H11.464ZM100.315 39H92.6985L76.4425 7.96L60.1225 39H52.6345L69.3385 6.744C70.6612 4.184 71.9198 2.47733 73.1145 1.624C74.3092 0.770664 75.2905 0.343998 76.0585 0.343998H77.0185C77.4025 0.343998 77.8292 0.429331 78.2985 0.599998C78.7678 0.770665 79.2798 1.112 79.8345 1.624C80.3892 2.09333 80.9865 2.75467 81.6265 3.608C82.2665 4.41866 82.9278 5.464 83.6105 6.744L100.315 39ZM113.612 39H107.02V9.944C107.02 8.62133 107.234 7.36267 107.66 6.168C108.13 4.97333 108.812 3.94933 109.708 3.096C110.604 2.2 111.735 1.496 113.1 0.983997C114.508 0.471999 116.151 0.216 118.028 0.216H152.333V6.68H118.028C116.62 6.68 115.511 7.08533 114.7 7.896C113.89 8.664 113.484 9.85867 113.484 11.48V16.408H152.333V22.872H113.612V39ZM184.925 39H182.685C178.888 39 175.624 38.6587 172.893 37.976C170.163 37.2507 167.901 36.12 166.109 34.584C164.36 33.048 163.059 31.064 162.205 28.632C161.352 26.2 160.925 23.256 160.925 19.8C160.925 13.1013 162.675 8.17333 166.173 5.016C169.715 1.816 175.24 0.216 182.749 0.216H184.861C192.328 0.216 197.832 1.816 201.373 5.016C204.915 8.17333 206.685 13.1013 206.685 19.8C206.685 23.256 206.259 26.2 205.405 28.632C204.552 31.064 203.229 33.048 201.438 34.584C199.688 36.12 197.427 37.2507 194.653 37.976C191.923 38.6587 188.68 39 184.925 39ZM184.861 6.68H183.005C177.587 6.68 173.64 7.78933 171.165 10.008C168.691 12.184 167.453 15.4267 167.453 19.736C167.453 24.088 168.669 27.3093 171.101 29.4C173.576 31.4907 177.523 32.536 182.941 32.536H184.669C190.088 32.536 194.013 31.512 196.445 29.464C198.92 27.3733 200.157 24.152 200.157 19.8C200.157 15.5333 198.92 12.2907 196.445 10.072C194.013 7.85333 190.152 6.72267 184.861 6.68ZM244.004 22.872H215.268V16.408H244.004V22.872ZM288.002 35.48L259.074 9.24V39H252.61V4.184C252.61 1.53867 253.698 0.216 255.874 0.216H257.346C257.944 0.301332 258.562 0.514665 259.202 0.855999C259.842 1.19733 260.61 1.70933 261.506 2.392L291.458 29.592V0.216H297.922V35.096C297.922 37.6987 296.856 39 294.722 39H293.634C293.037 38.872 292.248 38.5307 291.266 37.976C290.285 37.4213 289.197 36.5893 288.002 35.48ZM330.515 39H328.275C324.478 39 321.214 38.6587 318.483 37.976C315.753 37.2507 313.491 36.12 311.699 34.584C309.95 33.048 308.649 31.064 307.795 28.632C306.942 26.2 306.515 23.256 306.515 19.8C306.515 13.1013 308.265 8.17333 311.763 5.016C315.305 1.816 320.83 0.216 328.339 0.216H330.451C337.918 0.216 343.422 1.816 346.963 5.016C350.505 8.17333 352.275 13.1013 352.275 19.8C352.275 23.256 351.849 26.2 350.995 28.632C350.142 31.064 348.819 33.048 347.027 34.584C345.278 36.12 343.017 37.2507 340.243 37.976C337.513 38.6587 334.27 39 330.515 39ZM330.451 6.68H328.595C323.177 6.68 319.23 7.78933 316.755 10.008C314.281 12.184 313.043 15.4267 313.043 19.736C313.043 24.088 314.259 27.3093 316.691 29.4C319.166 31.4907 323.113 32.536 328.531 32.536H330.259C335.678 32.536 339.603 31.512 342.035 29.464C344.51 27.3733 345.747 24.152 345.747 19.8C345.747 15.5333 344.51 12.2907 342.035 10.072C339.603 7.85333 335.742 6.72267 330.451 6.68ZM396.25 35.48L367.322 9.24V39H360.858V4.184C360.858 1.53867 361.946 0.216 364.122 0.216H365.594C366.191 0.301332 366.81 0.514665 367.45 0.855999C368.09 1.19733 368.858 1.70933 369.754 2.392L399.706 29.592V0.216H406.17V35.096C406.17 37.6987 405.103 39 402.97 39H401.882C401.285 38.872 400.495 38.5307 399.514 37.976C398.533 37.4213 397.445 36.5893 396.25 35.48Z" fill="white"/>
        </svg>
    </div>
  </div>
  <Toastiff :toastOptions="toastOptions" />
</template>
<script>
import Toastiff from '@/Utils/Toastiff.vue';
import Icons from '@/components/Template/Icons.vue';
import axios from '@/Utils/axios';
export default {
  name: "LoginPage",
  components: {
    Icons,
    Toastiff
  },
  data() {
  return {
    login: '',
    showSvg:false,
    password: '',
    type: false,
    loading: false, 
    toastOptions: {
      open: false,
      text: "",
    },
  }
},
methods: {
  async handleLogin() {
    
    if (!this.login || !this.password) {
      this.toastOptions = {
        open: true,
        text: "Iltimos, login va parolni kiriting",
        type: "error",
      };
      return;
    }

    this.loading = true; 

    try {
      const response = await axios.post('/api/login', {
        username: this.login,
        password: this.password
      });
      
      if (response.status === 200) {
        this.toastOptions = {
          open: true,
          text: "Вход успешен",
          type:"success",
        };
        localStorage.setItem('user', JSON.stringify(response.data));
        this.$router.push('/');
      }
    } catch (error) {
      this.toastOptions = {
        open: true,
        text: error.response?.data?.message || "Xatolik yuz berdi",
        type: "error"
      };
    } finally {
      this.loading = false;
    }
  }
},
mounted() {
  setTimeout(() => {
    this.showSvg = true;
  }, 0); 
}

}
</script>
<style></style>